<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kioks Kamonji - Native</title>
    <link rel="icon" href="https://rochmadnf.my.id/assets/images/favicon.png" />

    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  </head>

  <body class="text-gray-900 relative">
    <div
      class="absolute top-8 right-8 size-8 rounded-full bg-green-500 inline-flex items-center justify-center"
    >
      <a href="./settings.html">⚙️</a>
    </div>
    <div class="absolute z-10 top-4 left-4">
      <div class="flex items-center gap-2 text-sm">
        <span id="prefix" class="text-gray-900"></span>
        <a
          id="creditLink"
          class="text-blue-500 font-medium"
          href="https://instagram.com/rochmadnf"
          target="_blank"
          rel="noopener noreferrer"
          ><span id="handle" class="text-blue-500 font-medium"></span
        ></a>
        <span id="mid" class="text-gray-900"></span>
        <strong id="org" class="text-gray-900"></strong>
        <span id="cursor" class="text-gray-900">|</span>
      </div>
    </div>

    <!-- Minimal caret blink and typing styles -->
    <style>
      #cursor {
        animation: blink 1s steps(2, start) infinite;
      }
      @keyframes blink {
        50% {
          opacity: 0;
        }
      }
    </style>
    <main class="h-dvh w-screen flex flex-col items-center justify-center">
      <!-- Alert container -->
      <div id="alertContainer" class="mt-4"></div>

      <!-- Form Input NIK -->
      <form id="formNik">
        <div class="grid gap-6 mb-6">
          <div class="w-fit flex flex-row items-center gap-2">
            <div>
              <label
                for="nik"
                class="block mb-2 text-sm font-bold text-gray-900"
                >NIK</label
              >
              <input
                maxlength="16"
                type="text"
                id="nik"
                name="nik"
                required
                autofocus
                class="text-center bg-gray-50 border border-gray-300 text-gray-900 text-xl tracking-widest font-mono rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
              />
            </div>
            <button
              id="submitBtn"
              type="submit"
              class="self-end text-white bg-blue-700 hover:bg-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-300 font-medium rounded-full text-sm px-5 py-2.5 text-center me-2 mb-2"
            >
              Cek
            </button>
          </div>
        </div>
      </form>

      <!-- List Layanan -->
      <div
        id="layananList"
        class="mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"
      ></div>

      <!-- Typing effect for top-right credit (prefix, handle link, organization) -->
      <script>
        (function () {
          const prefixEl = document.getElementById("prefix");
          const handleEl = document.getElementById("handle");
          const midEl = document.getElementById("mid");
          const orgEl = document.getElementById("org");
          if (!prefixEl || !handleEl || !midEl || !orgEl) return;

          const segments = [
            { el: prefixEl, text: "Made with ❤️ by " },
            { el: handleEl, text: "@rochmadnf" },
            { el: midEl, text: " at " },
            { el: orgEl, text: "UPTD. Puskesmas Kamonji" },
          ];

          const speed = 80; // ms per character
          const pauseBetweenSegments = 300; // ms
          const endPause = 10000; // pause after full message

          function typeSegment(index) {
            const seg = segments[index];
            let k = 0;
            function step() {
              if (k <= seg.text.length) {
                seg.el.textContent = seg.text.slice(0, k);
                k++;
                setTimeout(step, speed);
              } else {
                // move to next segment or finish
                if (index + 1 < segments.length) {
                  setTimeout(
                    () => typeSegment(index + 1),
                    pauseBetweenSegments
                  );
                } else {
                  // finished full message: pause then clear and restart
                  setTimeout(() => {
                    segments.forEach((s) => (s.el.textContent = ""));
                    setTimeout(() => typeSegment(0), 500);
                  }, endPause);
                }
              }
            }
            step();
          }

          if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", () => typeSegment(0));
          } else {
            typeSegment(0);
          }
        })();
      </script>

      <script src="./script.js" type="module"></script>
    </main>
  </body>
</html>
